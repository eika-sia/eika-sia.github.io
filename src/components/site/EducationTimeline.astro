---
// ProgressBar import removed (no longer used after simplification)
import HistoryItem from './HistoryItem.astro';
import educationData from '../../data/education.json';

interface EducationItem {
  institution: string;
  location: string;
  degree: string;
  start: string;
  end: string;
  gpa: string;
  ects: number;
  ectsTotal: number;
  focus: string;
  coursework: string[];
}

const educations: EducationItem[] = educationData as EducationItem[];
---

<div class="flex flex-col gap-4 md:gap-6 education-stack px-1 sm:px-2 max-w-3xl mx-auto">
  {educations.map((edu: EducationItem) => {
    // Compute progress (cap at 100%). If ectsTotal is 0 treat as complete for percentage.
    let progress = Math.min(1, edu.ects / (edu.ectsTotal || 1));
    if (edu.ectsTotal === 0) progress = 1;
    return (
      <HistoryItem
        title={edu.degree}
        org={edu.institution}
        location={edu.location}
        start={edu.start}
        end={edu.end}
        type="academic"
      >
  <div class="mt-5 space-y-5">
          <div class="mt-1">
            <div class="flex items-end justify-between w-full gap-6 text-[var(--accent-soft)]">
              <span class="flex-1 text-left text-lg md:text-xl font-semibold leading-none">
                {Math.round(progress * 100)}<span class="text-xs align-top">%</span>
              </span>
              <span class="flex-1 text-center text-sm md:text-base font-medium mono tracking-wide">
                {edu.ectsTotal !== 0 ? `${edu.ects} / ${edu.ectsTotal} ECTS` : 'â€”'}
              </span>
              <span class="flex-1 text-right text-sm md:text-base font-medium mono tracking-wide">
                GPA {edu.gpa}
              </span>
            </div>
          </div>
          <div class="space-y-3">
            <p class="text-slate-300 text-sm md:text-base leading-relaxed">
              <span class="text-[var(--accent-soft)] font-semibold">Focus:</span> {edu.focus}
            </p>
            {edu.coursework.length > 0 && (
        <div class="flex flex-wrap gap-3 md:gap-3.5">
                {edu.coursework.map((course: string) => (
          <span class="badge !text-[10px] md:!text-[11px] tracking-wide opacity-90 px-3 py-1.5 md:px-3.5 md:py-1.5">{course}</span>
                ))}
              </div>
            )}
          </div>
        </div>
      </HistoryItem>
    );
  })}
</div>
